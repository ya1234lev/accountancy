<section class="card transactions-card">
  <div class="card-header">
    <h3 class="card-title">
      <svg class="card-icon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
        <path d="M3,3H21V5H3V3M3,7H21V9H3V7M3,11H21V13H3V11M3,15H21V17H3V15M3,19H21V21H3V19Z"/>
      </svg>
      רשימת עסקאות ({{transactions.length}})
    </h3>
    <div class="card-actions">
      <button (click)="exportToExcel()" class="btn btn--secondary" [disabled]="transactions.length === 0">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M14,2H6A2,2 0 0,0 4,4V20A2,2 0 0,0 6,22H18A2,2 0 0,0 20,20V8L14,2M18,20H6V4H13V9H18V20Z"/>
        </svg>
        ייצא Excel
      </button>
      <button (click)="clearAllData()" class="btn btn--danger" [disabled]="transactions.length === 0">
        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor">
          <path d="M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z"/>
        </svg>
        נקה הכל
      </button>
    </div>
  </div>
  
  <div class="card-body" [class.no-padding]="transactions.length > 0">
    <div class="table-container" *ngIf="transactions.length > 0">
      <table class="data-table">
        <thead>
          <tr>
            <th (click)="sortBy('date')" style="cursor:pointer">
              תאריך
              <span class="sort-arrow" [class.active-arrow]="sortColumn === 'date'" [class.asc]="sortColumn === 'date' && sortDirection === 'asc'" [class.desc]="sortColumn === 'date' && sortDirection === 'desc'">
                {{sortColumn === 'date' ? (sortDirection === 'asc' ? '▲' : '▼') : '↕'}}
              </span>
            </th>
            <th (click)="sortBy('description')" style="cursor:pointer">
              תיאור
              <span class="sort-arrow" [class.active-arrow]="sortColumn === 'description'" [class.asc]="sortColumn === 'description' && sortDirection === 'asc'" [class.desc]="sortColumn === 'description' && sortDirection === 'desc'">
                {{sortColumn === 'description' ? (sortDirection === 'asc' ? '▲' : '▼') : '↕'}}
              </span>
            </th>
            <th (click)="sortBy('amount')" style="cursor:pointer">
              סכום
              <span class="sort-arrow" [class.active-arrow]="sortColumn === 'amount'" [class.asc]="sortColumn === 'amount' && sortDirection === 'asc'" [class.desc]="sortColumn === 'amount' && sortDirection === 'desc'">
                {{sortColumn === 'amount' ? (sortDirection === 'asc' ? '▲' : '▼') : '↕'}}
              </span>
            </th>
            <th (click)="sortBy('type')" style="cursor:pointer">
              סוג
              <span class="sort-arrow" [class.active-arrow]="sortColumn === 'type'" [class.asc]="sortColumn === 'type' && sortDirection === 'asc'" [class.desc]="sortColumn === 'type' && sortDirection === 'desc'">
                {{sortColumn === 'type' ? (sortDirection === 'asc' ? '▲' : '▼') : '↕'}}
              </span>
            </th>
            <th (click)="sortBy('client')" style="cursor:pointer">
              לקוח/ספק
              <span class="sort-arrow" [class.active-arrow]="sortColumn === 'client'" [class.asc]="sortColumn === 'client' && sortDirection === 'asc'" [class.desc]="sortColumn === 'client' && sortDirection === 'desc'">
                {{sortColumn === 'client' ? (sortDirection === 'asc' ? '▲' : '▼') : '↕'}}
              </span>
            </th>
            <th class="actions-col">פעולות</th>
          </tr>
        </thead>
        <tbody>
          <tr *ngFor="let transaction of transactions; let i = index" 
              [class.row--income]="transaction.type === 'income'"
              [class.row--expense]="transaction.type === 'expense'">
            <td class="cell--date">{{transaction.date | date:'dd/MM/yyyy'}}</td>
            <td class="cell--description">{{transaction.description}}</td>
            <td class="cell--amount" [class]="'amount--' + transaction.type">
              {{transaction.amount | number:'1.2-2'}} ₪
            </td>
            <td class="cell--type">
              <span class="badge" [class]="'badge--' + transaction.type">
                {{transaction.type === 'income' ? 'הכנסה' : 'הוצאה'}}
              </span>
            </td>
            <td class="cell--client">{{transaction.client || transaction.supplier}}</td>
            <td class="cell--actions">
              <button 
                (click)="deleteTransaction(i)" 
                class="btn btn--danger btn--sm"
                title="מחק עסקה">
                <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M7,6H17V19H7V6M9,8V17H11V8H9M13,8V17H15V8H13Z"/>
                </svg>
              </button>
            </td>
          </tr>
        </tbody>
      </table>
    </div>
    
    <div *ngIf="transactions.length === 0" class="empty-state">
      <svg class="empty-icon" width="64" height="64" viewBox="0 0 24 24" fill="currentColor">
        <path d="M19,3H5A2,2 0 0,0 3,5V19A2,2 0 0,0 5,21H19A2,2 0 0,0 21,19V5A2,2 0 0,0 19,3M19,19H5V5H19V19Z"/>
      </svg>
      <h4>אין עסקאות עדיין</h4>
      <p>התחל בהוספת עסקה חדשה באמצעות הטופס למעלה או העלה קובץ Excel/JSON</p>
    </div>
  </div>
</section>
